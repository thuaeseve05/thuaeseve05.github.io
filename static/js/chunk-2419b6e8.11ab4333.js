(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2419b6e8"],{1474:function(e,t,o){"use strict";o.r(t);o("c7cd");var i=o("7a23"),l=function(e){return Object(i["pushScopeId"])("data-v-4004ff6d"),e=e(),Object(i["popScopeId"])(),e},n={class:"gray",style:{width:"100%"}},a={class:"card-header"},r=l((function(){return Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("span",null,"快讯管理")],-1)})),c=Object(i["createTextVNode"])("添加"),d=l((function(){return Object(i["createElementVNode"])("div",{class:"image-slot",style:{width:"100px","min-height":"100px"}}," 加载中... ",-1)})),u=["about"],p=Object(i["createTextVNode"])("编辑"),f=Object(i["createTextVNode"])("删除"),s=l((function(){return Object(i["createElementVNode"])("img",{width:"60",height:"60",src:"https://ave.s3.ap-east-1.amazonaws.com/token_icon/defaultToken.png",alt:"",srcset:""},null,-1)})),b=Object(i["createTextVNode"])("zh"),m=Object(i["createTextVNode"])("en"),g=Object(i["createTextVNode"])("及时发送"),h=Object(i["createTextVNode"])(" 定时发送 "),O={key:1,class:"red"},j=Object(i["createTextVNode"])("取消"),C=Object(i["createTextVNode"])("确认"),w={style:{width:"300px",height:"300px"}},V={class:"dialog-footer"},v=Object(i["createTextVNode"])("取 消"),x=Object(i["createTextVNode"])("确定");function N(e,t,o,l,N,y){var _=this,k=Object(i["resolveComponent"])("el-button"),T=Object(i["resolveComponent"])("el-table-column"),S=Object(i["resolveComponent"])("el-image"),z=Object(i["resolveComponent"])("el-table"),B=Object(i["resolveComponent"])("el-pagination"),L=Object(i["resolveComponent"])("el-card"),U=Object(i["resolveComponent"])("el-col"),D=Object(i["resolveComponent"])("el-row"),E=Object(i["resolveComponent"])("el-input"),A=Object(i["resolveComponent"])("el-form-item"),$=Object(i["resolveComponent"])("UploadFilled"),F=Object(i["resolveComponent"])("el-icon"),M=Object(i["resolveComponent"])("CircleCloseFilled"),I=Object(i["resolveComponent"])("el-radio"),R=Object(i["resolveComponent"])("el-radio-group"),H=Object(i["resolveComponent"])("el-date-picker"),W=Object(i["resolveComponent"])("el-form"),P=Object(i["resolveComponent"])("el-dialog"),q=Object(i["resolveComponent"])("vueCropper"),J=Object(i["resolveDirective"])("loading");return Object(i["openBlock"])(),Object(i["createElementBlock"])("main",n,[Object(i["createVNode"])(D,null,{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(U,{span:24,style:{"margin-bottom":"10px"}},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(L,{class:"box-card",shadow:"never"},{header:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",a,[r,Object(i["createVNode"])(k,{class:"button",type:"primary",link:"",onClick:Object(i["withModifiers"])(y.handelAdd,["stop"])},{default:Object(i["withCtx"])((function(){return[c]})),_:1},8,["onClick"])])]})),default:Object(i["withCtx"])((function(){return[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createBlock"])(z,{data:N.tableData,stripe:"",style:{width:"100%"}},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(T,{label:"标题",align:"center","show-overflow-tooltip":""},{default:Object(i["withCtx"])((function(e){var t=e.row;return[Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(t.title),1)]})),_:1}),Object(i["createVNode"])(T,{label:"正文",align:"center","show-overflow-tooltip":""},{default:Object(i["withCtx"])((function(e){var t=e.row;return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.full_text),1)]})),_:1}),Object(i["createVNode"])(T,{prop:"picture_link",label:"图片",width:"200"},{default:Object(i["withCtx"])((function(e){var t=e.row;return[Object(i["createVNode"])(S,{style:{width:"100px"},fit:"contain","preview-src-list":[t.media],src:t.media,lazy:"","preview-teleported":""},{placeholder:Object(i["withCtx"])((function(){return[d]})),_:2},1032,["preview-src-list","src"])]})),_:1}),Object(i["createVNode"])(T,{prop:"lang",label:"语言",align:"center"}),Object(i["createVNode"])(T,{label:"url",width:"200",align:"center","show-overflow-tooltip":""},{default:Object(i["withCtx"])((function(e){var t=e.row;return[Object(i["createElementVNode"])("a",{about:t.url,target:"_blank"},Object(i["toDisplayString"])(t.url),9,u)]})),_:1}),Object(i["createVNode"])(T,{prop:"created_at",label:"发送时间",width:"200",align:"center"},{default:Object(i["withCtx"])((function(t){var o=t.row;return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(o.created_at?e.$f.formatDate(o.created_at):"--"),1)]})),_:1}),Object(i["createVNode"])(T,{label:"操作",width:"250",align:"right",fixed:"right"},{default:Object(i["withCtx"])((function(e){var t=e.row;return[Object(i["createVNode"])(k,{type:"primary",link:"",onClick:Object(i["withModifiers"])((function(e){return y.handelEdit(t)}),["stop"])},{default:Object(i["withCtx"])((function(){return[p]})),_:2},1032,["onClick"]),Object(i["createVNode"])(k,{type:"primary",link:"",onClick:Object(i["withModifiers"])((function(e){return y.handelRemove(t)}),["stop"])},{default:Object(i["withCtx"])((function(){return[f]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])),[[J,N.dataLoading]]),Object(i["createVNode"])(B,{style:{display:"flex",width:"100%","justify-content":"center",margin:"30px 0 0 0"},currentPage:N.pageNO,"onUpdate:currentPage":t[0]||(t[0]=function(e){return N.pageNO=e}),"page-size":N.pageSize,background:"",layout:"total, prev, pager, next",total:N.total,onSizeChange:y.handleSizeChange,onCurrentChange:y.handleCurrentChange},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"])]})),_:1})]})),_:1})]})),_:1}),Object(i["createVNode"])(P,{title:y.dialogTitle,modelValue:N.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=function(e){return N.dialogVisible=e}),width:"600px",top:"5vh","close-on-click-modal":!1,onClosed:y.handelClose},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(W,{model:N.form,rules:N.rules,ref:"form",onSubmit:Object(i["withModifiers"])(y.updateNews,["prevent"]),"label-width":"auto"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(A,{label:"标题",prop:"title"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(E,{modelValue:N.form.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return N.form.title=e}),clearable:""},null,8,["modelValue"])]})),_:1}),Object(i["createVNode"])(A,{label:"正文",prop:"fulltext"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(E,{modelValue:N.form.fulltext,"onUpdate:modelValue":t[2]||(t[2]=function(e){return N.form.fulltext=e}),modelModifiers:{trim:!0},rows:3,type:"textarea",placeholder:"正文描述",clearable:""},null,8,["modelValue"])]})),_:1}),Object(i["createVNode"])(A,{label:"图片"},{default:Object(i["withCtx"])((function(){return[N.form.media?(Object(i["openBlock"])(),Object(i["createBlock"])(S,{key:0,class:"img-preview",src:N.form.media,fit:"fill"},{error:Object(i["withCtx"])((function(){return[s]})),_:1},8,["src"])):Object(i["createCommentVNode"])("",!0)]})),_:1}),Object(i["createVNode"])(A,{label:"上传图片",prop:"profile_picture"},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("label",{for:"uploaderFile-1",class:"img-preview",style:Object(i["normalizeStyle"])({backgroundImage:N.fileUrl?"url("+N.fileUrl+")":""})},[N.fileUrl?(Object(i["openBlock"])(),Object(i["createBlock"])(F,{key:1,onClick:Object(i["withModifiers"])(y.removeFile,["stop","prevent"]),class:"el-icon-error"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(M)]})),_:1},8,["onClick"])):(Object(i["openBlock"])(),Object(i["createBlock"])(F,{key:0,class:"el-icon-upload"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])($)]})),_:1}))],4),Object(i["createElementVNode"])("input",{type:"file",ref:"fileLogo",id:"uploaderFile-1",accept:"image/png, image/jpeg, image/gif, image/jpg",onChange:t[3]||(t[3]=function(){return y.beforeUpload&&y.beforeUpload.apply(y,arguments)})},null,544)]})),_:1}),Object(i["createVNode"])(A,{label:"语言"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(R,{modelValue:N.form.lang,"onUpdate:modelValue":t[4]||(t[4]=function(e){return N.form.lang=e})},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(I,{label:"zh"},{default:Object(i["withCtx"])((function(){return[b]})),_:1}),Object(i["createVNode"])(I,{label:"en"},{default:Object(i["withCtx"])((function(){return[m]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),Object(i["createVNode"])(A,{label:"fileUrl",prop:"url"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(E,{modelValue:N.form.url,"onUpdate:modelValue":t[5]||(t[5]=function(e){return N.form.url=e}),modelModifiers:{trim:!0},placeholder:"请输入url",clearable:""},null,8,["modelValue"])]})),_:1}),Object(i["createVNode"])(A,{label:"发送时间",prop:"createdAt"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(R,{modelValue:N.timeType,"onUpdate:modelValue":t[7]||(t[7]=function(e){return N.timeType=e}),class:"mr-10"},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(I,{label:"1",size:"large"},{default:Object(i["withCtx"])((function(){return[g]})),_:1}),Object(i["createVNode"])(I,{label:"2",size:"large"},{default:Object(i["withCtx"])((function(){return[h,"2"===N.timeType?(Object(i["openBlock"])(),Object(i["createBlock"])(H,{key:0,modelValue:N.form.createdAt,"onUpdate:modelValue":t[6]||(t[6]=function(e){return N.form.createdAt=e}),clearable:"",type:"datetime","value-format":"X",placeholder:"选择时间"},null,8,["modelValue"])):Object(i["createCommentVNode"])("",!0),""!==N.form.createdAt&&null!==N.form.createdAt||"2"!==_.timeType?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",O,"* 必填项"))]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),Object(i["createVNode"])(A,{label:""},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(k,{onClick:t[8]||(t[8]=function(e){return N.dialogVisible=!1})},{default:Object(i["withCtx"])((function(){return[j]})),_:1}),Object(i["createVNode"])(k,{type:"primary","native-type":"submit",loading:N.addLoading},{default:Object(i["withCtx"])((function(){return[C]})),_:1},8,["loading"])]})),_:1})]})),_:1},8,["model","rules","onSubmit"])]})),_:1},8,["title","modelValue","onClosed"]),Object(i["createVNode"])(P,{title:"上传icon",modelValue:N.uploadDialogVisible,"onUpdate:modelValue":t[11]||(t[11]=function(e){return N.uploadDialogVisible=e}),width:"600px"},{footer:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("span",V,[Object(i["createVNode"])(k,{onClick:t[10]||(t[10]=function(e){return N.uploadDialogVisible=!1})},{default:Object(i["withCtx"])((function(){return[v]})),_:1}),Object(i["createVNode"])(k,{type:"primary",loading:N.getCropBlobLoading,onClick:y.getCropBlob},{default:Object(i["withCtx"])((function(){return[x]})),_:1},8,["loading","onClick"])])]})),default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",w,[Object(i["createVNode"])(q,{ref:"cropper",img:N.option.img,outputSize:N.option.outputSize,outputType:N.option.outputType,maxImgSize:N.option.maxImgSize,enlarge:N.option.enlarge,high:N.option.high,autoCrop:N.option.autoCrop,autoCropWidth:N.option.autoCropWidth,autoCropHeight:N.option.autoCropHeight,fixed:N.option.fixed,centerBox:N.option.centerBox,canScale:N.option.canScale,fixedBox:N.option.fixedBox},null,8,["img","outputSize","outputType","maxImgSize","enlarge","high","autoCrop","autoCropWidth","autoCropHeight","fixed","centerBox","canScale","fixedBox"])])]})),_:1},8,["modelValue"])])}var y=o("5530"),_=(o("d9e2"),o("d3b7"),o("d81d"),o("159b"),o("b64b"),o("99af"),o("3ca3"),o("ddb0"),o("2b3d"),o("9861"),o("365c")),k=(o("179a"),o("04b0")),T={name:"Blacklist",components:{VueCropper:k["a"]},data:function(){var e=this,t=function(t,o,i){return""!==o&&null!==o||"2"!==e.timeType?i():i(new Error)};return{form:{id:"",title:"",fulltext:"",media:"",lang:"",profile_picture:"",url:"",createdAt:""},rules:{title:[{required:!0,message:"必填项",trigger:"blur"}],createdAt:[{required:!0,trigger:"change",validator:t}]},tableData:[],dataLoading:!1,addLoading:!1,updateLoading:!1,dialogVisible:!1,uploadDialogVisible:!1,option:{img:"",outputSize:.2,outputType:"png",maxImgSize:200,enlarge:.5,high:!1,autoCrop:!0,autoCropWidth:"200",autoCropHeight:"200",fixed:!0,centerBox:!0,canScale:!1,fixedBox:!0},file:"",fileUrl:"",getCropBlobLoading:!1,dialogTitleType:1,pageNO:1,pageSize:20,total:0,timeType:"1"}},computed:{dialogTitle:function(){var e={1:"添加",2:"编辑"};return e[this.dialogTitleType]}},created:function(){this.getNewsList()},methods:{getNewsList:function(){var e=this;this.dataLoading=!0,Object(_["Nb"])(this.pageNO,this.pageSize).then((function(t){var o;e.total=t.Total||0,e.tableData=(null===t||void 0===t||null===(o=t.List)||void 0===o?void 0:o.map((function(e){var t,o,i,l,n,a,r,c,d,u,p,f,s,b,m,g;return Object(y["a"])(Object(y["a"])({},e),{},{title:null===(t=e.content)||void 0===t||null===(o=t.items)||void 0===o||null===(i=o[0])||void 0===i||null===(l=i.legacy)||void 0===l?void 0:l.title,full_text:null===(n=e.content)||void 0===n||null===(a=n.items)||void 0===a||null===(r=a[0])||void 0===r||null===(c=r.legacy)||void 0===c?void 0:c.full_text,media:null===(d=e.content.items)||void 0===d||null===(u=d[0])||void 0===u||null===(p=u.media)||void 0===p||null===(f=p[0])||void 0===f||null===(s=f.legacy)||void 0===s?void 0:s.media_url_https,lang:null===(b=e.content.items)||void 0===b||null===(m=b[0])||void 0===m||null===(g=m.legacy)||void 0===g?void 0:g.lang})})))||[]})).catch((function(t){console.warn(t),e.tableData=[]})).finally((function(){e.dataLoading=!1}))},handleCurrentChange:function(e){this.pageNO=e,this.getNewsList(this.pageNO,this.pageSize)},handleSizeChange:function(e){this.pageSize=e,this.getNewsList(this.pageNO,this.pageSize)},handelAdd:function(){this.dialogTitleType=1,this.dialogVisible=!0,this.removeFile(),this.form={id:"",title:"",fulltext:"",media:"",lang:"",profile_picture:"",url:"",createdAt:""}},updateNews:function(){var e=this;this.$refs.form.validate((function(t){if(t){e.addLoading=!0,e.form.createdAt="1"===e.timeType?Math.floor(Date.now()/1e3):e.form.createdAt;var o=new FormData;Object(y["a"])({},e.form);Object.keys(e.form).forEach((function(t){var i,l=null!==(i=e.form[t])&&void 0!==i?i:"";"profile_picture"===t&&""!==l?o.append("profile_picture",l,"".concat(e.form.title,"-").concat(Date.now(),".png")):"media"!==t&&""!==l&&o.append(t,l)})),1===e.dialogTitleType?Object(_["p"])(o).then((function(t){e.$message.success("添加成功"),e.dialogVisible=!1,e.getNewsList(e.pageNO,e.pageSize)})).catch((function(t){console.log(t),e.$message.error("添加失败")})).finally((function(){e.addLoading=!1})):Object(_["id"])(o).then((function(t){e.$message.success("更新成功"),e.dialogVisible=!1,e.getNewsList(e.pageNO,e.pageSize)})).catch((function(t){console.log(t),e.$message.error("更新失败")})).finally((function(){e.addLoading=!1}))}}))},beforeUpload:function(e){var t=e.target.files[0];if(t.size/1024/1024>1)return this.$message.error("图片大小超出限制"),!1;this.form.profile_picture=t,this.fileUrl=window.URL.createObjectURL(t)},removeFile:function(){this.form.profile_picture=null,this.fileUrl="",this.$refs.fileLogo&&(this.$refs.fileLogo.value=""),this.option.img=""},getCropBlob:function(){var e=this;this.$refs.cropper.getCropBlob((function(t){var o=new File([t],e.form.token_address);e.form.profile_picture=o,e.fileUrl=window.URL.createObjectURL(o),e.uploadDialogVisible=!1}))},handelEdit:function(e){this.dialogTitleType=2,this.form={id:e.id,title:e.title,fulltext:e.full_text,media:e.media,lang:e.lang,profile_picture:"",url:e.url,createdAt:e.created_at},this.form.createdAt&&(this.timeType="2"),this.dialogVisible=!0},handelClose:function(){this.$refs.form.resetFields(),this.timeType="1"},handelRemove:function(e){var t=this;this.$messageBox.confirm("确定要删除".concat(e.title,"吗?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((function(){Object(_["Dc"])(e.id).then((function(e){t.$message({type:"success",message:"删除成功！"}),t.getNewsList(t.pageNO,t.pageSize)})).catch((function(e){console.log(e),t.$message({type:"error",message:e})}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))}}},S=(o("63d0"),o("6b0d")),z=o.n(S);const B=z()(T,[["render",N],["__scopeId","data-v-4004ff6d"]]);t["default"]=B},"63d0":function(e,t,o){"use strict";o("a4f9")},a4f9:function(e,t,o){},d81d:function(e,t,o){"use strict";var i=o("23e7"),l=o("b727").map,n=o("1dde"),a=n("map");i({target:"Array",proto:!0,forced:!a},{map:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);